<!DOCTYPE html>
<html>
  <head>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-28637942-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-28637942-1');
  </script>
  
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  <title>The affect of latency on MSSQL INSERTs</title>
  <meta name="description" content="SQL is a network application and according to The Fallacies of Distributed Computing tells us that in any network application latency is non-zero. In this article we will explore the effect of latency on SQL insert performance from the scenarios in my last post.">
  <meta name="author" content="Luke McGregor">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="The affect of latency on MSSQL INSERTs">
  <meta name="twitter:description" content="SQL is a network application and according to The Fallacies of Distributed Computing tells us that in any network application latency is non-zero. In this article we will explore the effect of latency on SQL insert performance from the scenarios in my last post.">
  
  <meta name="twitter:creator" content="staticv0id">
  
  <meta name="twitter:image" content="/images/favicons/favicon-194x194.png" />

  <meta property="og:type" content="article">
  <meta property="og:title" content="The affect of latency on MSSQL INSERTs">
  <meta property="og:description" content="SQL is a network application and according to The Fallacies of Distributed Computing tells us that in any network application latency is non-zero. In this article we will explore the effect of latency on SQL insert performance from the scenarios in my last post.">
  <meta property="og:image" content="/images/favicons/favicon-194x194.png" />

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css?1529806504632661198">
  <link rel="canonical" href="http://blog.staticvoid.co.nz/2012/the_affect_of_latency_on_mssql_inserts/">
  <link rel="alternate" type="application/rss+xml" title="StaticVoid" href="/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
	<div class="panel-main">

		<div class="panel-main__inner panel-inverted">
			<div class="panel-main__content">
				<a href="/" title="link to home of StaticVoid">
					<img src="https://www.gravatar.com/avatar/46e93e55b8f4f652201516c2f7bf3323?s=256" class="user-image" alt="Profile Photo">
					<div class="staticvoid-logo">
						<div class="wrapper">
							<div class="code">static void;</div>
							<div class="comment">// Blog</div>
						</div>
					</div>
				</a>
				<hr class="panel-cover__divider">

				<div class="navigation-wrapper">

					<nav class="cover-navigation cover-navigation--primary">
						<ul class="navigation">							
							<li class="navigation__item"><a href="/" title="Tech">Tech</a></li>
							<li class="navigation__item"><a href="/personal" title="Personal">Personal</a></li>
						</ul>
					</nav>

					<nav class="cover-navigation navigation--social">
						<ul class="navigation">

							
							<!-- Twitter -->
							<li class="navigation__item">
								<a href="http://twitter.com/staticv0id" title="@staticv0id on Twitter" target="_blank">
									<i class="icon icon-social-twitter"></i>
									<span class="label">Twitter</span>
								</a>
							</li>
							   
							<!-- GitHub -->
							<li class="navigation__item">
								<a href="https://www.github.com/lukemcgregor" title="lukemcgregor on GitHub" target="_blank">
									<i class="icon icon-social-github"></i>
									<span class="label">GitHub</span>
								</a>
							</li>
							 

							<!-- RSS -->
							<li class="navigation__item">
								<a href="/feed.xml" title="Subscribe" target="_blank">
									<i class="icon icon-rss"></i>
									<span class="label">RSS</span>
								</a>
							</li>

						</ul>
					</nav>

				</div>

			</div>

		</div>

		<div class="panel-cover--overlay"></div>
	</div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="27 Aug 2012" class="post-meta__date date">27 Aug 2012</time>
      
    </div>
    <h1 class="post-title">The affect of latency on MSSQL INSERTs</h1>
  </header>

  <section class="post">
    <p>When dealing with any networked system a number of factors become important which do not apply when writing applications which run on a single machine. As a developers its very easy to overlook some of the aspects of developing for networked systems. The <a href="http://en.wikipedia.org/wiki/Fallacies_of_Distributed_Computing">Fallacies of Distributed Computing</a> remind us not to make assumptions about networks.</p>

<p>The second fallacy of distributed computing is that <a href="https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing">latency is zero</a>. In this article we are going to look at the impacts of latency on insert performance and especially how latency affects each of the bulk insert scenarios which were discussed in my previous article <a href="http://blog.staticvoid.co.nz/2012/08/mssql-and-large-insert-statements.html">MSSQL and large INSERT statements</a>.</p>

<p>I have selected several different amounts of latency as below:</p>

<ul>
  <li>No added latency, this simulates a typical scenario where your DB server is in the same rack as your client.</li>
  <li>5ms, this is a fairly low latency scenario which simulates your DB server being on the same campus/data center as your client but behind a few routers.</li>
  <li>10ms, this simulates your DB server being in the same city as your client but not the same campus.</li>
  <li>30ms, this simulates a cross country connection where your DB server may be in a different city to your client.</li>
  <li>100ms, if you are unfortunate enough to have your DB on the other side of a major ocean you’re in big trouble.</li>
</ul>

<h3 id="latency-and-basic-sql-command-inserts">Latency and basic SQL Command inserts</h3>

<p><img src="/images/posts/2012/latency-impact-on-basic-sql-commands.png" alt="Latency Impact on Basic SQL Commands" /></p>

<p>As we can see from the above graph that latency linearly increases the time taken to insert each row. We can see this as on our log graph the curves appear offset but have no apparent differences in the steepness of the curves. However when we look at the actual time impact that this has it is fairly clear that latency is not our friend here. For example inserting 1000 rows at 5ms latency takes us around 7.5s whereas with 100ms latency those same 1000 rows take 103s (which matches conceptually with a direct linear correlation, 95ms * 1000 <em>rows</em> + 7.5s <em>5ms baseline</em> = 102.5s).</p>

<h3 id="how-our-scenarios-compare-with-latency">How our scenarios compare with latency</h3>

<p><img src="/images/posts/2012/no-added-latency.png" alt="No added latency" /></p>

<p><img src="/images/posts/2012/5ms-latency.png" alt="5ms latency" /></p>

<p><img src="/images/posts/2012/10ms-latency.png" alt="10ms latency" /></p>

<p><img src="/images/posts/2012/30ms-latency.png" alt="30ms latency" /></p>

<p><img src="/images/posts/2012/100ms-latency.png" alt="100ms latency" /></p>

<p>As you can see as latency increases, a basic SQL command approach performs comparability worse however each of our three alternatives remain comparability similar to each other. This shows that the affect of latency is substantially lower on each of our alternate methods of inserting data.</p>

<h3 id="what-does-it-mean-for-developing-applications">What does it mean for developing applications</h3>

<p>For developers and admins alike it is particularly important to understand the potential impacts latency can have on SQL performance. What’s more these problems are not going to be limited to insert based statements; every call to a database incurs a non-zero latency cost.</p>

<p>With cloud computing and geographically dispersed companies becoming more prevalent data is not always located close to where it is used. While this isn’t ideal by paying attention to latency when we construct applications and frameworks makes us far more resilient to higher latency scenarios when they do occur. Remember the <a href="http://en.wikipedia.org/wiki/Fallacies_of_Distributed_Computing">Fallacies of Distributed Computing</a> and don’t assume that latency is insignificant.</p>

<p>With SQL batching multiple statements into a single statement or transmission will save round trips which means they will cope a lot better with latency.</p>

<p>My raw data and graphs can be downloaded <a href="/files/posts/2012/Performance%20results%20-%20latency%20comparisons.xlsx"><strong>here</strong></a>.</p>

<p><strong>Note</strong>: in this article when discussing latency we are considering <strong>round trip time (RTT)</strong> not one directional latency</p>

  </section>
  <section id="disqus_thread"></section><!-- /#disqus_thread -->
</article>

    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'http://blog.staticvoid.co.nz/2012/the_affect_of_latency_on_mssql_inserts/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = '/2012/the_affect_of_latency_on_mssql_inserts'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };

      (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//staticvoidblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
       })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



<script type="application/ld+json">
{ "@context": "http://schema.org",
 "@type": "BlogPosting",
 "headline": "The affect of latency on MSSQL INSERTs",
 "wordcount": "597",
 "publisher": "StaticVoid",
 "mainEntityOfPage": "http://blog.staticvoid.co.nz/2012/the_affect_of_latency_on_mssql_inserts/",
 "publisher": {
   "@type": "Organization",
   "name": "StaticVoid",
  "logo":{
    "@type":"ImageObject",
    "url": "http://blog.staticvoid.co.nz/images/favicons/favicon-194x194.png"
  }
 },
 "datePublished": "2012-08-27 00:00:00 +0000",
 "description": "SQL is a network application and according to The Fallacies of Distributed Computing tells us that in any network application latency is non-zero. In this article we will explore the effect of latency on SQL insert performance from the scenarios in my last post.",
   "author": {
    "@type": "Person",
    "name": "Luke McGregor"
	,"image": "https://www.gravatar.com/avatar/46e93e55b8f4f652201516c2f7bf3323?s=256"
  }
 }
</script>

      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2018 Luke McGregor. All rights reserved.</span>
</footer>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js?1529806504632661198"></script>


    </div>
  </body>
</html>