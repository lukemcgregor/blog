<!DOCTYPE html>
<html>
  <head>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-28637942-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-28637942-1');
  </script>
  
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  <title>Multiple Repository Data Contexts with my Repository Pattern</title>
  <meta name="description" content="I recently needed to have links to multiple different database contexts within an application I was developing using StaticVoid.Core.Repository. I use ninject for all of my dependency injection and I though it might be useful to share how I managed to get the repository binding correctly to different versions of DbContext depending on the type requested.">
  <meta name="author" content="Luke McGregor">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Multiple Repository Data Contexts with my Repository Pattern">
  <meta name="twitter:description" content="I recently needed to have links to multiple different database contexts within an application I was developing using StaticVoid.Core.Repository. I use ninject for all of my dependency injection and I though it might be useful to share how I managed to get the repository binding correctly to different versions of DbContext depending on the type requested.">
  
  <meta name="twitter:creator" content="staticv0id">
  
  <meta name="twitter:image" content="/images/favicons/favicon-194x194.png" />

  <meta property="og:type" content="article">
  <meta property="og:title" content="Multiple Repository Data Contexts with my Repository Pattern">
  <meta property="og:description" content="I recently needed to have links to multiple different database contexts within an application I was developing using StaticVoid.Core.Repository. I use ninject for all of my dependency injection and I though it might be useful to share how I managed to get the repository binding correctly to different versions of DbContext depending on the type requested.">
  <meta property="og:image" content="/images/favicons/favicon-194x194.png" />

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css?1533546547300072615">
  <link rel="canonical" href="http://blog.staticvoid.co.nz/2012/multiple_repository_data_contexts_with_my_repository_pattern/">
  <link rel="alternate" type="application/rss+xml" title="StaticVoid" href="/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
	<div class="panel-main">

		<div class="panel-main__inner panel-inverted">
			<div class="panel-main__content">
				<a href="/" title="link to home of StaticVoid">
					<img src="https://www.gravatar.com/avatar/46e93e55b8f4f652201516c2f7bf3323?s=256" class="user-image" alt="Profile Photo">
					<div class="staticvoid-logo">
						<div class="wrapper">
							<div class="code">static void;</div>
							<div class="comment">// Blog</div>
						</div>
					</div>
				</a>
				<hr class="panel-cover__divider">

				<div class="navigation-wrapper">

					<nav class="cover-navigation cover-navigation--primary">
						<ul class="navigation">							
							<li class="navigation__item"><a href="/" title="Tech">Tech</a></li>
							<li class="navigation__item"><a href="/personal" title="Personal">Personal</a></li>
						</ul>
					</nav>

					<nav class="cover-navigation navigation--social">
						<ul class="navigation">

							
							<!-- Twitter -->
							<li class="navigation__item">
								<a href="http://twitter.com/staticv0id" title="@staticv0id on Twitter" target="_blank">
									<i class="icon icon-social-twitter"></i>
									<span class="label">Twitter</span>
								</a>
							</li>
							   
							<!-- GitHub -->
							<li class="navigation__item">
								<a href="https://www.github.com/lukemcgregor" title="lukemcgregor on GitHub" target="_blank">
									<i class="icon icon-social-github"></i>
									<span class="label">GitHub</span>
								</a>
							</li>
							 

							<!-- RSS -->
							<li class="navigation__item">
								<a href="/feed.xml" title="Subscribe" target="_blank">
									<i class="icon icon-rss"></i>
									<span class="label">RSS</span>
								</a>
							</li>

						</ul>
					</nav>

				</div>

			</div>

		</div>

		<div class="panel-cover--overlay"></div>
	</div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="9 Jan 2012" class="post-meta__date date">9 Jan 2012</time>
      
    </div>
    <h1 class="post-title">Multiple Repository Data Contexts with my Repository Pattern</h1>
  </header>

  <section class="post">
    <p>I recently needed to have links to multiple different database contexts within an application I was developing using StaticVoid.Core.Repository. I use ninject for all of my dependency injection and I though it might be useful to share how I managed to get the repository binding correctly to different versions of DbContext depending on the type requested. Below is a little extension method I wrote to deal with this problem:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="kt">bool</span> <span class="nf">IsInjectingToRepositoryDataSourceOfNamespace</span><span class="p">(</span>
         <span class="k">this</span> <span class="n">IRequest</span> <span class="n">request</span><span class="p">,</span> <span class="kt">string</span> <span class="n">entityNamespace</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">ParentRequest</span><span class="p">.</span><span class="n">Service</span><span class="p">.</span><span class="nf">GetGenericTypeDefinition</span><span class="p">()</span> <span class="p">==</span>
         <span class="k">typeof</span><span class="p">(</span><span class="n">IRepositoryDataSource</span><span class="p">&lt;&gt;))</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">request</span><span class="p">.</span><span class="n">ParentRequest</span><span class="p">.</span><span class="n">Service</span><span class="p">.</span><span class="nf">GetGenericArguments</span><span class="p">().</span><span class="nf">First</span><span class="p">().</span><span class="n">Namespace</span>
             <span class="p">==</span> <span class="n">entityNamespace</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>This can then be used in the following way:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Bind</span><span class="p">&lt;</span><span class="n">DbContext</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Data1Context</span><span class="p">&gt;().</span><span class="nf">When</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span>
	<span class="n">t</span><span class="p">.</span><span class="nf">IsInjectingToRepositoryDataSourceOfNamespace</span><span class="p">(</span><span class="s">"MyApp.Data1"</span><span class="p">));</span>
<span class="n">Bind</span><span class="p">&lt;</span><span class="n">DbContext</span><span class="p">&gt;().</span><span class="n">To</span><span class="p">&lt;</span><span class="n">Data2Context</span><span class="p">&gt;().</span><span class="nf">When</span><span class="p">(</span><span class="n">t</span> <span class="p">=&gt;</span>
	<span class="n">t</span><span class="p">.</span><span class="nf">IsInjectingToRepositoryDataSourceOfNamespace</span><span class="p">(</span><span class="s">"MyApp.Data2"</span><span class="p">));</span>
</code></pre></div></div>

<p>This makes it quite tidy to link to multiple data contexts and means that anywhere in your app ninject will infer the data context for that type based on the namespace of the type.</p>

  </section>
  <section id="disqus_thread"></section><!-- /#disqus_thread -->
</article>

    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'http://blog.staticvoid.co.nz/2012/multiple_repository_data_contexts_with_my_repository_pattern/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = '/2012/multiple_repository_data_contexts_with_my_repository_pattern'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };

      (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//staticvoidblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
       })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



<script type="application/ld+json">
{ "@context": "http://schema.org",
 "@type": "BlogPosting",
 "headline": "Multiple Repository Data Contexts with my Repository Pattern",
 "wordcount": "235",
 "publisher": "StaticVoid",
 "mainEntityOfPage": "http://blog.staticvoid.co.nz/2012/multiple_repository_data_contexts_with_my_repository_pattern/",
 "publisher": {
   "@type": "Organization",
   "name": "StaticVoid",
  "logo":{
    "@type":"ImageObject",
    "url": "http://blog.staticvoid.co.nz/images/favicons/favicon-194x194.png"
  }
 },
 "datePublished": "2012-01-09 00:00:00 +0000",
 "description": "I recently needed to have links to multiple different database contexts within an application I was developing using StaticVoid.Core.Repository. I use ninject for all of my dependency injection and I though it might be useful to share how I managed to get the repository binding correctly to different versions of DbContext depending on the type requested.",
   "author": {
    "@type": "Person",
    "name": "Luke McGregor"
	,"image": "https://www.gravatar.com/avatar/46e93e55b8f4f652201516c2f7bf3323?s=256"
  }
 }
</script>

      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2018 Luke McGregor. All rights reserved.</span>
</footer>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js?1533546547300072615"></script>


    </div>
  </body>
</html>