<!DOCTYPE html>
<html>
  <head>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-28637942-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-28637942-1');
  </script>
  
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  <title>Adding a custom verb to all web parts in SharePoint</title>
  <meta name="description" content="So I was trying to add a menu item to all web parts in a SharePoint 2007 site collection. Surely such a thing should be simple to achieve. I expected it to be implemented in a similar way to adding to the ECB drop downs in a document library or something like the site actions menu. However menu items on web parts are implemented by the base ASP.Net web part framework using a concept called verbs.

">
  <meta name="author" content="Luke McGregor">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Adding a custom verb to all web parts in SharePoint">
  <meta name="twitter:description" content="So I was trying to add a menu item to all web parts in a SharePoint 2007 site collection. Surely such a thing should be simple to achieve. I expected it to be implemented in a similar way to adding to the ECB drop downs in a document library or something like the site actions menu. However menu items on web parts are implemented by the base ASP.Net web part framework using a concept called verbs.

">
  
  <meta name="twitter:creator" content="staticv0id">
  
  <meta name="twitter:image" content="/images/favicons/favicon-194x194.png" />

  <meta property="og:type" content="article">
  <meta property="og:title" content="Adding a custom verb to all web parts in SharePoint">
  <meta property="og:description" content="So I was trying to add a menu item to all web parts in a SharePoint 2007 site collection. Surely such a thing should be simple to achieve. I expected it to be implemented in a similar way to adding to the ECB drop downs in a document library or something like the site actions menu. However menu items on web parts are implemented by the base ASP.Net web part framework using a concept called verbs.

">
  <meta property="og:image" content="/images/favicons/favicon-194x194.png" />

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css?1585442661398746257">
  <link rel="canonical" href="http://blog.staticvoid.co.nz/2010/adding_a_custom_verb_to_all_web_parts_in_sharepoint/">
  <link rel="alternate" type="application/rss+xml" title="StaticVoid" href="/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
	<div class="panel-main">

		<div class="panel-main__inner panel-inverted">
			<div class="panel-main__content">
				<a href="/" title="link to home of StaticVoid">
					<img src="https://www.gravatar.com/avatar/46e93e55b8f4f652201516c2f7bf3323?s=256" class="user-image" alt="Profile Photo">
					<div class="staticvoid-logo">
						<div class="wrapper">
							<div class="code">static void;</div>
							<div class="comment">// Blog</div>
						</div>
					</div>
				</a>
				<hr class="panel-cover__divider">

				<div class="navigation-wrapper">

					<nav class="cover-navigation cover-navigation--primary">
						<ul class="navigation">							
							<li class="navigation__item"><a href="/" title="Tech">Tech</a></li>
							<li class="navigation__item"><a href="/personal" title="Personal">Personal</a></li>
						</ul>
					</nav>

					<nav class="cover-navigation navigation--social">
						<ul class="navigation">

							
							<!-- Twitter -->
							<li class="navigation__item">
								<a href="http://twitter.com/staticv0id" title="@staticv0id on Twitter" target="_blank">
									<i class="icon icon-social-twitter"></i>
									<span class="label">Twitter</span>
								</a>
							</li>
							   
							<!-- GitHub -->
							<li class="navigation__item">
								<a href="https://www.github.com/lukemcgregor" title="lukemcgregor on GitHub" target="_blank">
									<i class="icon icon-social-github"></i>
									<span class="label">GitHub</span>
								</a>
							</li>
							 

							<!-- RSS -->
							<li class="navigation__item">
								<a href="/feed.xml" title="Subscribe" target="_blank">
									<i class="icon icon-rss"></i>
									<span class="label">RSS</span>
								</a>
							</li>

						</ul>
					</nav>

				</div>

			</div>

		</div>

		<div class="panel-cover--overlay"></div>
	</div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="16 Aug 2010" class="post-meta__date date">16 Aug 2010</time>
      
    </div>
    <h1 class="post-title">Adding a custom verb to all web parts in SharePoint</h1>
  </header>

  <section class="post">
    <p>So I was trying to add a menu item to all web parts in a SharePoint 2007 site collection. Surely such a thing should be simple to achieve. I expected it to be implemented in a similar way to adding to the ECB drop downs in a document library or something like the site actions menu. However menu items on web parts are implemented by the base ASP.Net web part framework using a concept called verbs.</p>

<p>The verbs for a web part are stored on the <code class="highlighter-rouge">System.Web.UI.WebControls.WebParts.WebPart</code> class in a read only property. From my research an posts on the MSFT developer forums there’s no good way to break into this collection. So basically I was left with a problem, how do I get my own menu item into this list. I thought of two basic ways to do this, firstly use reflection to write to the property or secondly use JavaScript to add the menu item to the page on the fly.</p>

<p>It turns out that the Verbs property on WebPart simply returns an empty collection. This makes it difficult, so it was down to the JavaScript option. It turns out that the default menu options on a web part aren’t returned from the verbs property. Instead there are other properties control the visibility of these default items. The defaults are written to the bottom of the page in a hidden section and conditionally rendered into the dropdown.</p>

<p>This can be done with JQuery and a couple of web services. I created a delegate control containing my script and injected it into the page head. Running the line below on page load will inject a custom menu item into all WebPart dropdowns on the page.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#MSOMenu_WebPartMenu</span><span class="dl">'</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;ie:menuitem hello="" id="Menu_MyMenuItem" onclick="javascript:alert(" type="option" world");"=""&gt; Hello World&lt;/ie:menuitem&gt;</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p>There are however a few limitations to this, Firstly it only works in IE, other browsers render verbs in a completely different way (no dropdown even), and secondly it will only work with javascript enabled.</p>

<p>If anyone has any other approaches to this problem I would love to hear about them</p>

  </section>
  <section id="disqus_thread"></section><!-- /#disqus_thread -->
</article>

    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'http://blog.staticvoid.co.nz/2010/adding_a_custom_verb_to_all_web_parts_in_sharepoint/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = '/2010/adding_a_custom_verb_to_all_web_parts_in_sharepoint'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };

      (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//staticvoidblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
       })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



<script type="application/ld+json">
{ "@context": "http://schema.org",
 "@type": "BlogPosting",
 "headline": "Adding a custom verb to all web parts in SharePoint",
 "wordcount": "363",
 "publisher": "StaticVoid",
 "mainEntityOfPage": "http://blog.staticvoid.co.nz/2010/adding_a_custom_verb_to_all_web_parts_in_sharepoint/",
 "publisher": {
   "@type": "Organization",
   "name": "StaticVoid",
  "logo":{
    "@type":"ImageObject",
    "url": "http://blog.staticvoid.co.nz/images/favicons/favicon-194x194.png"
  }
 },
 "datePublished": "2010-08-16 00:00:00 +0000",
 "description": "<p>So I was trying to add a menu item to all web parts in a SharePoint 2007 site collection. Surely such a thing should be simple to achieve. I expected it to be implemented in a similar way to adding to the ECB drop downs in a document library or something like the site actions menu. However menu items on web parts are implemented by the base ASP.Net web part framework using a concept called verbs.</p>

",
   "author": {
    "@type": "Person",
    "name": "Luke McGregor"
	,"image": "https://www.gravatar.com/avatar/46e93e55b8f4f652201516c2f7bf3323?s=256"
  }
 }
</script>

      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2020 Luke McGregor. All rights reserved.</span>
</footer>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js?1585442661398746257"></script>


    </div>
  </body>
</html>